#!/bin/sh
BUILDPATH="/tmp/build"
APIGEN="docker run -v $BUILDPATH:$BUILDPATH --rm vfac/apigen"
mkdir $BUILDPATH
cp -R src $BUILDPATH

if [ "${TRAVIS_BRANCH}" != "master" ]; then
  rm -rf docs/${TRAVIS_BRANCH}/*
  $APIGEN generate $BUILDPATH/src/ --destination $BUILDPATH/docs/${TRAVIS_BRANCH}
else
  rm docs/*
  rm -rf docs/*
  $APIGEN generate $BUILDPATH/src/ --destination $BUILDPATH/docs/
fi

cp -R $BUILDPATH/docs/* docs
